---
title: "AE 05 - Nobel Winners - Data Import and Export"
author: "Your Name"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: show
  pdf_document:
    toc: true
    latex_engine: xelatex
    keep_tex: false
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

## Introduction

In this application exercise, you'll practice reading data from CSV files and writing data out to new files. You'll work with Nobel Prize winner data and split it into subsets based on the prize category.

**In this application exercise, you will:**

- Read CSV files with `read_csv()`
- Filter data into subsets
- Write data to CSV files with `write_csv()`
- Understand file paths and data organization
- Practice reproducible data workflows

**Estimated time:** 20-30 minutes

---

## Getting Started

### Fork and Clone Workflow

**Quick reminder:** Work in YOUR forked `application-exercises` repository.

1. Navigate to the `ae-05-import-export` folder in YOUR fork
2. Open `ae-05-nobel.Rmd`
3. Update the YAML with your name
4. Verify the `data-raw` folder exists with `nobel.csv`

---

## Packages
```{r load-packages, warning=FALSE, message=FALSE}
library(tidyverse)
```

---

## Understanding File Paths

Before we start, let's understand the folder structure:
```
ae-05-import-export/
├── nobel-csv.Rmd          # This file
├── sales-excel.Rmd          # Other file
├── data-raw/                 # Folder with raw data
│   ├── nobel.csv
│   └── sales.xlsx
└── data/                     # Folder for processed data (you'll create files here)
```

**File paths:**

- To read from `data-raw`: `"data-raw/nobel.csv"`
- To write to `data`: `"data/filename.csv"`

---

## Exercise 1: Read the Data

Let's first load the data from the `nobel.csv` file in the `data-raw` folder.

**Fill in the blanks:**
```{r read-nobel, eval = FALSE}
nobel <- read_csv("___")
```

**Hint:** The file path is `"data-raw/nobel.csv"`

**What `read_csv()` does:**

- Reads comma-separated values (CSV) files
- Automatically detects column types
- Returns a tibble (tidyverse data frame)

**Verify it worked:**
```{r check-nobel, eval = FALSE}
# Look at the structure
glimpse(nobel)

# See the first few rows
head(nobel)
```

**Task 1.1:** How many Nobel laureates are in the dataset?

**Your answer:** _____ laureates

**Task 1.2:** What variables are in the dataset?

**Your answer:**

___________________________________________________________________________

---

## Exercise 2: Split the Data

Nobel prizes are awarded in different categories. Let's split the data into two groups:

- **STEM laureates:** Physics, Chemistry, Medicine
- **Non-STEM laureates:** Literature, Peace, Economics

**First, explore the categories:**
```{r explore-categories, eval = FALSE}
# See what categories exist
nobel %>%
  count(category)
```

**STEM categories:** Physics, Chemistry, Medicine (Physiology or Medicine)

**Non-STEM categories:** Literature, Peace, Economic Sciences

**Task 2.1:** Fill in the blanks to create a dataset of STEM laureates.
```{r stem-laureates, eval = FALSE}
# STEM laureates
nobel_stem <- nobel %>%
  filter(category %in% c("___", "___", "___"))
```

**Hints:**

- Use exact category names from the count above
- Medicine might be called "Physiology or Medicine"
- Use `%in%` to check if category is in a vector of values

**How many STEM laureates are there?**
```{r count-stem, eval = FALSE}
nrow(nobel_stem)
```

**Your answer:** _____ STEM laureates

**Task 2.2:** Fill in the blanks to create a dataset of non-STEM laureates.

**Option 1: List the non-STEM categories explicitly**
```{r non-stem-option1, eval = FALSE}
# Non-STEM laureates (explicit)
nobel_non_stem <- nobel %>%
  filter(category %in% c("___", "___", "___"))
```

**Option 2: Use NOT IN to exclude STEM categories**
```{r non-stem-option2, eval = FALSE}
# Non-STEM laureates (using negation)
nobel_non_stem <- nobel %>%
  filter(!(category %in% c("Physics", "Chemistry", "Physiology or Medicine")))
```

**Explanation of `!(x %in% y)`:**

- `%in%`: Checks if values are in a vector
- `!`: Negation (NOT)
- Together: "NOT in the list"

**How many non-STEM laureates are there?**
```{r count-non-stem, eval = FALSE}
nrow(nobel_non_stem)
```

**Your answer:** _____ non-STEM laureates

**Verification check:**
```{r verify-split, eval = FALSE}
# STEM + non-STEM should equal total
nrow(nobel_stem) + nrow(nobel_non_stem) == nrow(nobel)
```

**Does this equal TRUE?** _____

---

## Exercise 3: Write Out the Data

Now let's save these two subsets as separate CSV files in the `data` folder.

**Create the data folder first (if it doesn't exist):**
```{r create-data-folder}
# Create data folder (won't error if it already exists)
dir.create("data", showWarnings = FALSE)
```

**Task 3.1:** Write the STEM laureates data to a CSV file.
```{r write-stem, eval = FALSE}
write_csv(___, "data/___.csv")
```

**Hints:**
- First argument: the data frame to write (`nobel_stem`)
- Second argument: the file path (`"data/nobel-stem.csv"`)

**Task 3.2:** Write the non-STEM laureates data to a CSV file.
```{r write-non-stem, eval = FALSE}
write_csv(___, "data/___.csv")
```

**Hint:** Use a different filename like `"data/nobel-non-stem.csv"`

**Verify the files were created:**
```{r verify-files, eval= FALSE}
# List files in the data folder
list.files("data")
```

**You should see:**

- `nobel-stem.csv`
- `nobel-non-stem.csv`

---

## Exercise 4: Read the Data Back In

To verify everything worked, let's read one of the files we just created.
```{r read-back, eval = FALSE}
# Read the STEM file back in
stem_check <- read_csv("data/nobel-stem.csv")

# Check the number of rows
nrow(stem_check)
```

**Does the number of rows match what you expected?** _____

---

## Exercise 5: Explore the Subsets

**Task 5.1:** Which STEM category has the most laureates?
```{r stem-by-category, eval = FALSE}
nobel_stem %>%
  count(___, sort = TRUE)
```

**Your answer:** _____ has the most STEM laureates.

**Task 5.2:** Which decade had the most non-STEM laureates?

**Hint:** You'll need to create a decade variable first.
```{r non-stem-by-decade, eval = FALSE}
nobel_non_stem %>%
  mutate(decade = (year %/% 10) * 10) %>%  # Create decade variable
  count(___, sort = TRUE)
```

**Your answer:** The _____s had the most non-STEM laureates.

---

## Exercise 6: Challenge (Optional)

**Task 6.1:** Create a summary that shows the number of laureates by category and gender.
```{r category-gender-summary, eval = FALSE}
nobel %>%
  count(___, ___) %>%
  pivot_wider(names_from = ___, values_from = ___)
```

**Task 6.2:** Write this summary to a CSV file called `nobel-summary.csv`.
```{r write-summary}
# Your code here
```

---

## Reflection

**What did you learn about file organization and data workflows?**

___________________________________________________________________________
___________________________________________________________________________

**Why is it useful to split data into subsets?**

___________________________________________________________________________

---

## Knit and Submit

**Before you finish:**

1. ✅ Make sure all code chunks run without errors
2. ✅ Fill in all blanks
3. ✅ Check that CSV files were created in the `data` folder
4. ✅ Knit to HTML first

**Git workflow:**

1. Make sure to **stage** (check boxes for):
   - `nobel-csv.Rmd`
   - `data/nobel-stem.csv`
   - `data/nobel-non-stem.csv`
2. Click **Commit**
3. Write message: "Completed AE 05 - Nobel"
4. Click **Commit** then **Push**

**Important:** Commit BOTH your code AND the CSV files you created!

---

## Troubleshooting

**Common issues:**

- **Error: "cannot open file":** Check your file path - make sure `data-raw/nobel.csv` exists
- **Error: "cannot open file" when writing:** The `data` folder might not exist - run the `dir.create()` code
- **File paths on Windows:** Use forward slashes `/` not backslashes `\`
- **Can't find created files:** Look in the `data` folder in the Files pane

**CSV reading/writing:**

- **Strange characters in data:** CSV file might have encoding issues
- **Quotes around text:** Normal for CSV files with commas in the text
- **Want different delimiter:** Use `read_csv2()` for semicolons or `read_delim()` for custom delimiters

**Filter issues:**

- **`%in%` not working:** Make sure values match exactly (check spelling and capitalization)
- **Categories not matching:** Use `count(category)` to see exact category names

**If you're stuck:**
- Check the Files pane to verify folder structure
- Review the walkthrough video
- Ask on the discussion board

---

## Quick Reference

**Reading data:**
```r
data <- read_csv("path/to/file.csv")
```

**Writing data:**
```r
write_csv(data, "path/to/output.csv")
```

**File paths:**

- Same folder: `"file.csv"`
- Subfolder: `"folder/file.csv"`
- Parent folder: `"../file.csv"`

**Useful file functions:**

- `list.files("folder")`: List files in a folder
- `dir.create("folder")`: Create a new folder
- `file.exists("file.csv")`: Check if file exists